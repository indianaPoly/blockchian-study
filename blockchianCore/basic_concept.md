# 블록체인 개요: 핵심 개념 정리

## 0. 블록체인의 핵심 기술

- 블록체인 핵심 기술
  - P2P network : 기존의 클라이언트-서버 간의 구조를 타파, 참여자들이 이루어지는 네트워크
    - 구조적 P2P
    - 비구조적 P2P
      - 서버를 중심으로 참여자들 간의 망이 이루어이는 중앙 집중형 네트워크
      - flooding 알고리즘을 기반으로 하는 분산형 P2P 네트워크
    - P2P 통신은 UDP를 이용하는 것이 일반적이지만 블록체인 같은 경우 TCP/IP를 사용 (자신과 물리적으로 가장 인접한 참여자들의 IP를 유지)
  - 암호화 알고리즘
    - 무결성 검증을 위한 머클 트리
      - 하위 트리들의 해시 값을 기반으로 하여 블록의 해시 값을 이루고 있으므로, 루트 노드의 해시를 검증하는 것만으로도 위, 변조를 검증할 수 있다. (만약 변조가 된다고 하면, 상태가 변경된 것이므로 해시가 변경이 된다. 그렇게 되면 루트 노드의 해시도 동일하게 변동이 될 것)
    - 공개 키 기반 디지털 서명
      - 공개 키 기반 구조에서는 공개 키와 비밀 키 두 개의 키 쌍이 존재
      - 거래의 유효성을 검증 (거래를 발생시키는 사용자가 자신의 비밀 키를 사용하여 거래에 데대서 서명을 하면 이에 대응되는 공개 키와 함께 네크워크에 거래 정보를 전송, 검증자는 공개 키를 이용하여 해당 거래의 유효성을 검증함)
  - 분산합의
    - 작업 증명
    - 지분 증명
      - 위임 지분 증명
      - PBFT
  - 분산장부
    - 합의에 의해 복제, 공유, 동기화된 정보의 기록 저장소
  - 스마트 컨트랙트
    - 전자 상거래를 위한 컴퓨터 프로토콜
    - 자동화된 직접 거래를 가능하게 함

---

## 1. 블록체인에 대한 배경

- **정품 인증 보장**: 구매한 제품이 정품인지 확인
- **데이터 보안 보장**: 공유된 데이터가 안전하게 보호됨
- **신뢰 구축**: 기업과 개인 간의 신뢰를 강화

---

## 2. 블록체인의 기본 개념

- **중앙 기관 없이 거래와 결제 진행**
  - 하나의 기관에 의존하지 않음.
  - **Google Sheet**(공유된 장부) ↔ **Excel**(개인 파일, 변경 시 계속 업데이트 필요)

---

## 3. 블록체인의 속성

### 3.1 분산화 (Decentralization)

- **개인 키**로 자산을 직접 제어
- **중개자 의존성 제거** (예: 은행 없이 송금)
- 네트워크에 대한 **신뢰**가 기반
- **연중무휴 거래** 가능하며, 모든 참여자가 거래 내역을 볼 수 있어 투명성 보장

### 3.2 불변성 (Immutability)

- 블록체인에 기록된 데이터는 **수정 불가**
- 데이터가 추가된 후에는 **변경할 수 없음**

### 3.3 합의 (Consensus)

- **노드들 간의 동의**로 블록을 검증
- 노드의 합의 없이는 **어떤 거래도 추가될 수 없음**

---

## 4. 블록의 구성 요소

1. **제네시스 블록 (Genesis Block)**: 첫 번째 블록
2. **데이터와 거래 기록**: 각 블록에 포함된 거래 내역
3. **해시 (Hash)**
   - 블록과 그 안의 모든 내용을 나타내는 **고유 식별자**
   - 블록이 변경되면 해시도 변경되어 무결성을 보장
4. **이전 블록의 해시**: 블록 간 연결을 통해 **네트워크 보안** 강화
5. **타임스탬프**: 거래 시간 기록
6. **Nonce (넌스)**
   - 한 번만 사용되는 임의의 숫자
   - 유효한 블록 해시를 찾기 위해 사용됨

---

## 5. 해시 함수 (Hash Function)

- **입력 데이터에 대해 고정 길이의 출력 생성**
  - 대표 알고리즘: **SHA-256**, MD5, BLAKE2 등
  - SHA-256은 64자 크기의 256비트 해시를 생성
- **무차별 대입 공격 방지**: SHA-256에서는 공격자가 2^256번의 시도를 해야 성공 가능

### 해시 함수의 주요 특성

1. **민감성**: 입력 값이 조금만 바뀌어도 출력이 크게 달라짐
2. **빠른 계산 속도**
3. **결정론적**: 동일한 입력에 대해 항상 동일한 출력 반환
4. **단방향 함수**: 해시 값을 통해 원본 데이터를 역추적할 수 없음

---

## 6. 작업 증명 (Proof of Work, PoW)

- **합의 알고리즘**: 분산 네트워크에서 데이터의 유효성을 검증
- 거래를 완료하기 위해 **Nonce 값을 찾는 과정** 포함
- PoW를 통해 유효한 블록 해시를 생성하며, 이를 **채굴(Mining)**이라 부름

### 비트코인에서의 PoW 동작 원리

1. 사용자가 **네트워크에 새로운 거래를 제출**하면 각 노드가 이를 검증
2. 거래가 올바른지, 사용자가 충분한 비트코인을 보유하고 있는지 확인
3. 거래는 **개인 키로 서명**되어 제출
4. 비트코인은 계정 잔액 대신 **모든 거래 기록을 추적**
5. 거래는 **mempool**(미확인 거래 풀)에 보관

- 블록은 **최대 1MB** 데이터만 포함하며, 약 1500~3000개의 거래를 저장
- **수수료가 높은 거래**가 우선적으로 블록에 포함
- 채굴자는 **Nonce** 값을 찾아 유효한 해시를 생성하며, 보통 10분이 소요됨

---

## 7. 지분 증명 (Proof of Stake, PoS)

- **PoS 검증자 선택**
  - 코인을 예치하여 지분을 보유한 사용자가 블록 생성에 참여
  - **Coin Age**: 코인을 보유한 기간에 따라 검증자 우선순위 결정
- **검증자 페널티**: 부정행위 시 예치된 지분을 잃게 됨
- 새로운 블록을 만드는 과정을 **위조(Forging)**라 부름

---

## 8. 위임 지분 증명 (Delegated Proof of Stake, DPoS)

- PoS의 변형으로, **대리인을 통해 블록을 생성**
- **투표 시스템**을 통해 검증 노드를 선출하며, 투표에 따라 **가중치가 부여**
- 선출된 노드가 부정행위를 하면 **즉시 퇴출**

---

## 9. 블록체인 트릴레마 (Blockchain Trilemma)

- **분산화, 확장성, 보안** 간의 균형이 어려움
- 확장성을 높이면 분산화와 보안이 약화될 수 있음
- 이를 해결하기 위해 **Layer 1**과 **Layer 2** 솔루션이 개발됨

### Layer 1

- 비트코인, 이더리움과 같은 기본 블록체인 네트워크

### Layer 2

- **Layer 1 위에 구축된 오버레이 네트워크**
- 예: **상태 채널, 롤업, 플라즈마**
- **상태 채널**: 오프체인에서 거래를 처리하고 최종 결과만 Layer 1에 기록
- **롤업**: 여러 트랜잭션을 압축해 Layer 1에 제출

---

## 10. KYC와 블록체인 (Know Your Customer)

- **KYC 프로세스**: 고객의 신원을 검증하는 절차
- 블록체인을 통해 KYC 데이터를 공유하면 **중복 검증을 줄일 수 있음**
- 고객의 KYC 문서를 해시한 값을 블록체인에 저장하고, 다른 기관이 이를 활용
- **QR 코드**로 고객의 ID와 문서 해시를 조회하고 검증

---

## 11. 웹 3.0과 분산형 애플리케이션 (dApp)

- **dApp**: P2P 블록체인 네트워크에서 실행되는 분산형 애플리케이션
- **IPFS**(InterPlanetary File System)를 통해 데이터를 분산 저장
- 클라우드 대신 **IPFS에 프론트엔드 코드**를 호스팅해 중앙 집중화를 방지
